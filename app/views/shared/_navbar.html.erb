<header>
    <div class="navbar">
        <div class="navbar-container">  
            <div class="logo">
                <%= link_to "All Pay Auction", root_path %>
            </div>

            <div class="links">
                <li><%= link_to "Auction Block", auction_items_path %></li>
                <%= link_to "Sell", "/sell" %>
                <%= link_to "About Us", "/about" %>
            </div>

            <div class="user-links">
                <% if logged_in? %>
                    <div class="profile-btn">
                        <div class="user-name">
                            <%= current_user.first_name %> <%= current_user.last_name %>
                        </div>
                        <i class="fa-solid fa-chevron-down"></i>

                        <div class="profile-dropdown-menu">
                            <% if seller? %>
                                <%= link_to "Seller Dashboard", seller_dashboard_path %>
                            <% end %>
                            <%= link_to "Settings", "#", class: "temp" %>
                            <%= link_to "Logout", logout_path, method: :delete %>
                        </div>
                    </div>
                <% else %>
                    <%= link_to "Log in", login_path(account_type: params[:account_type] || "buyer"), class: "login-btn" %>
                    <%= link_to "Sign up", signup_path(account_type: params[:account_type] || "buyer"), class: "signup-btn" %>
                <% end %>
            </div>
        </div>
    </div>
</header>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const profileBtn = document.querySelector('.profile-btn');
        const profileBtnIcon = profileBtn.querySelector('i');
        const profileDropDownMenu = document.querySelector('.profile-dropdown-menu');

        profileBtn.addEventListener("click", function (event) {
            event.stopPropagation();
            const isOpen = profileDropDownMenu.classList.toggle('open');
            profileBtn.classList.toggle('active', isOpen);
            profileBtnIcon.classList = isOpen ? "fa-solid fa-chevron-up" : "fa-solid fa-chevron-down";
        });

        // Close dropdown when clicking outside
        document.addEventListener("click", function (event) {
            if (!profileBtn.contains(event.target) && !profileDropDownMenu.contains(event.target)) {
                profileDropDownMenu.classList.remove('open');
                profileBtn.classList.remove('active');
                profileBtnIcon.classList = "fa-solid fa-chevron-down";
            }
        });
    });
</script>
