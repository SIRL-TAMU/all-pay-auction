<h1>All Auction Items</h1>

<% @auction_items.each do |item| %>
  <div>
    <h2><%= link_to item.name, auction_item_path(item) %></h2>
    <p><%= item.description %></p>
    <p>Max Bid: $<%= item.max_bid %></p>
    <p>Closing Date: <%= item.closing_date.strftime('%Y-%m-%d') %></p>
    <%= image_tag(item.image.present? && item.image.start_with?("http") ? item.image : "https://images.pexels.com/photos/7004697/pexels-photo-7004697.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", width: 200) %>

    <% if buyer? %>
      <%= form_with(model: Bid.new, local: true) do |form| %>
        <%= form.hidden_field :auction_item_id, value: item.id %>
        <%= form.label :amount, "Your Bid:" %>
        <%= form.number_field :amount, step: 0.01, min: (item.max_bid + 0.01) %>
        <%= form.submit "Place Bid" %>
      <% end %>
    <% end %>
    
  </div>    
<% end %>

<% if seller? %>
  <%= link_to "Create New Auction", new_auction_item_path %>
<% end %>
